#
# pre-commit: auto linting
#

# color define
RED="\e[0;31m"
END="\e[0m"

# find clang-format
CLANG_FORMAT=`which clang-format`
if [ "$CLANG_FORMAT" = "" ]
then
	echo -n "${RED} Can't find clang-format ${END}.\n"
	exit 1
fi

# linting
CXX_FILES_FILTER="\.([chi](pp|xx)|(cc|hh|ii)|[CHI])$"
CXX_CHANGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -Ee "$CXX_FILES_FILTER")
if [ "$CXX_CHANGED_FILES" != "" ]
then
	$CLANG_FORMAT -i -style=file ${CXX_CHANGED_FILES}
fi

